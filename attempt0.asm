.data
	# Note: starting address always is 0x10010000
	
	#arr: .word 17767, 9158, -26519, 18547, -9135, 23807, -27574, 22764, -57559, -33587, 22714, -10325, 16882, 7931, -22045, 57670, 124, -40254, -63404, 10232, -56549, -5656, -12825, 17293, -61578, -55974, -1746, 29283, -15821, 55199, 50377, -63590, -1178, -41678, 20493, 55223, 47665, 58456, 12451, 55642, -40667, -30371, -20219, 41751, 43096, 23273, 33886, -22316, 48555, 36018
	arr: .word 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0
	#arr: .word 53453, 57542, -35173, -24908, 9300, -31215, -15346, -57982, 63604, 34369, 62753, 48445, 36316, -3961, -58768, -8727, -14274, 54433, -15807, 63713, 44540, 9063, -32194, -41215, -14722, -54633, 47594, -46372, -11413, 30614, 55183, -23496, 22620, -45526, 17132, -33616, -11205, -63749, -26062, -13137, 36156, -28844, -30228, 6936, 32731, -23460, 63746, -47078, -34562, -17597
	#arr: .word -48901, -55558, 57002, -15558, -31237, -23255, -4655, -49178, -4091, 49468, 46972, -14444, -39563, 4056, 5566, 43105, 35977, 59897, 44892, -55621, -18776, 15513, -18929, 16533, -43087, -51733, 58609, -44877, -33275, -41489, 3063, -16640, -31511, -5471, 33338, 2789, 36810, -36853, 19147, -32816, -52920, 583, 18276, -26947, -60897, -41693, -49378, 40616, -47332, 61051
	#arr: .word 50532, -571, 11028, -33933, -49574, 33477, -20130, -56501, 54137, 12131, -32453, -8336, 61028, 1572, 51729, 28830, -61175, 23004, 57514, 23508, 55724, -60942, -41445, 8464, -22353, -36805, 32307, -6195, -61725, 50512, -10680, 54343, -15595, -65188, -45125, 367, 33826, 281, 9402, 22427, -53123, 42485, -51445, -57631, -21478, -65252, 36735, -17117, 23288, 28713
	#arr: .word -59144, 13476, 33307, -35053, -43595, -54582, -6322, 54248, 4760, -2510, 39224, 59616, -13703, -41907, 59965, 6708, 23996, 28255, -58546, -32137, -14854, -46133, -55188, -763, -38228, -11130, -479, 64043, 37290, -42726, 27221, 43682, 36286, -5008, -56907, 58227, 5947, 2308, 46940, -54829, 65334, 20628, -60749, -13905, 44258, 64752, 58340, 2718, 27471, 65330
	#arr: .word 36117, -52919, -46339, 46466, 11854, -19031, -30200, -54160, -20524, -58446, -31350, -58839, 50772, -60600, 1690, 59402, 63164, -57899, -3826, 44568, -47192, -4028, -340, -42405, 47603, -21618, -43188, 40407, 46637, 49819, 40201, 17218, 62437, 59398, -1852, 8755, -25169, 33485, 20131, 19844, 40575, 54317, 26541, 25812, 59254, -37305, 19678, 56882, -29668, -49684
	#arr: .word 35914, -11324, 11824, -29962, 11808, -6109, 13957, 34156, -31237, -4942, 18439, -56572, -53260, 15340, -62709, 10425, -41440, -22342, -21626, 44227, 63038, -46587, 33009, 24044, 44761, 26727, 52275, -1097, 18073, -42928, 14755, -11549, 11284, -38957, 24025, -42444, 20471, -27554, 57248, 54770, 33040, 10152, 63734, 45317, -40044, -64511, -9794, -15948, -21316, 34116
	#arr: .word -37256, -23814, 53065, 61289, -65306, 32291, 22480, 52506, -34342, -24983, -55958, 45950, 29004, 20862, -58543, -12507, 43955, 27464, 25476, 35667, 16698, -7020, -19717, 14897, -27239, 5776, 15922, 28503, 55364, 60142, -2917, -47428, -29207, -15387, -51675, -28977, -48632, 36341, -42007, -17438, -54178, -32429, -37024, 40362, 53970, -30030, -37680, 32389, 62970, 53332
	#arr: .word 2520, 14133, -19224, 48340, -36506, 19074, -11420, 44952, -17959, -21592, 39559, 44661, -3483, -55184, -36262, 10378, -18625, -19358, -18816, 4905, 28740, -7458, 38012, 57253, -32631, 26446, -38313, -4775, -6701, -40879, -16979, 61356, 38790, 29333, 44160, -63252, -17129, -32796, 47237, 30449, 11148, 21260, 9574, -57871, 31612, 38848, 18044, -52549, -46046, 64764
	#arr: .word 17892, 48230, -8230, -9631, 39947, 24675, -48721, -63902, -45636, 10115, -39244, 2921, 5935, 65082, -33281, -15441, -63705, 15126, 17299, 49068, -19961, -37089, 4792, 55149, -29423, -29132, 28461, 54157, -16145, 47951, 53385, -63788, 30646, -20381, -7883, 5057, -61241, 8932, 6692, -41341, -46489, 32984, 27117, 24982, 32530, 59372, -55995, 34361, 8962, 26840
	#arr: .word 17893, 54538, 55288, -42851, 44151, -39671, -6447, 7077, -51050, 42945, -10508, -63201, 44693, -45398, -18046, -28726, 25196, -13751, 45742, -33648, 10445, 64790, 64872, -27974, 24236, 31866, -34138, 33778, 692, 40360, -4918, -46951, 29362, -15166, -24265, 7978, 10699, 34824, -50481, 25185, 12233, 4547, 27520, -8610, 24686, -56061, 28200, -15654, -4276, 8407
	#arr: .word 16234, -59367, 7661, 15570, -21805, -33639, -18100, 9593, -65397, 48128, -15582, -4778, -64358, -51756, 45592, -23087, 21758, -9244, -53799, 36813, -49595, 23971, -24175, 43462, -50175, -65025, 52937, 43562, -15143, -16875, -13567, -64445, -10705, 59630, 16661, 33026, -39545, 64097, -22916, -39405, 46690, 27038, 21353, 47868, 40818, 1409, -40755, -2959, 57701, -29018
	#arr: .word -31682, -57429, 60489, 9679, 51569, -55221, 10190, 38970, 53877, 60583, -43441, -25226, 61674, 11390, -31132, 12799, -21119, -5141, 11361, 21501, 20990, -7485, -16997, -23193, -25153, -41715, 43753, -372, 20862, 35918, 36146, 54717, 44025, 31100, -1140, 30058, 41415, -56485, 3492, 29756, -61438, 25588, -61006, -65299, -28558, -26602, 13036, 15859, 33793, -41139
	#arr: .word -28176, -10752, 16912, 20363, 31591, 57295, 44185, 9808, -8613, -489, -19809, -38002, -11308, -41320, 58634, 53089, 54275, 34513, 62140, -7769, -1267, -64834, -47717, 3263, -64597, -10738, 42197, 13976, -60415, 10454, 38373, -23054, 65238, -10250, 62845, 31294, -18491, 41494, -24434, 38433, -24530, 21293, -65105, 29698, 45510, 59065, 17251, 34249, 28042, 13855
	#arr: .word -39056, -38761, 14558, -21236, 30038, 15497, 33562, 6699, -36063, 38683, -48383, -63225, -49907, -48680, -7939, -52597, 48150, 39106, 54433, -41820, 12003, -35633, 45010, 12434, 59602, 24984, 5963, 11317, -6303, -31531, -40363, 20177, -4756, 39731, 64477, -40254, -10308, 32503, 31981, 19166, 5651, 49135, 21477, 21280, -65081, -51998, 34219, 48605, 52644, 23117
	#arr: .word -58751, -888, 53020, 51795, -53990, 47086, 11243, 17510, -7132, -60596, 51515, 18041, 25118, -18776, -7764, 24059, 6506, 47464, -8973, -27048, 1094, 62214, -43449, -42965, 17958, -42994, -29427, -13358, -59925, -42318, -55777, -53140, 22330, 62779, 64192, 33876, 44330, 9899, -14150, -28338, 14840, -28170, 55239, -25578, 18590, -18061, 64017, -40440, -36133, -1049
	#arr: .word -1952, 30498, -13814, 20135, 53069, -61391, 42677, -41893, -9213, 48288, -18675, 546, 60685, -61881, -2211, 59341, 37531, -23417, 3704, -42154, 13781, -46992, -4788, 3484, -7034, -51734, 50959, -8552, -26638, -50709, 46492, 36947, 45325, -32857, -8454, 32858, -28712, -31312, 56501, 27611, -48560, -27710, -37379, -53411, -24055, 25946, -59606, -52059, -63006, 9635
	#arr: .word -28677, 16311, 28179, 32071, -45740, -44390, 45873, -60317, 12594, -46301, -45490, -6450, 56182, 65371, 26229, -17807, 32694, 63053, 16417, 23659, 25128, 33393, 61486, 53285, 45519, -28105, 13696, 51449, -14628, 16226, -4452, 22231, -32999, -41808, -11234, -13203, -20662, -30897, -7983, 57468, -11661, 12063, -14518, -21015, 11899, -53824, 26714, -20943, -56307, -22405
	#arr: .word -62820, 34358, -54547, 64202, 22107, 56508, -29438, -29733, 42421, 21470, 52029, -27566, -21834, -46505, -3838, 32468, 5828, 41036, -63964, 63381, 32968, -10089, 9909, -47086, 34432, -43728, -35374, -4389, 865, -26144, 38742, 3581, -57322, 49731, 2248, 30321, 40703, 38346, -64947, 17589, -5720, 52618, 55559, 37982, -59423, -13815, 4915, 11942, -38315, 6487
	# 20 random list of numbers to count median of number of instructions and running time.
	ketqua: .asciiz "Ket qua: "			#c8
	space: .asciiz " "				#d2	

#	(in qua trinh chay)
	begin: .asciiz "Bat dau qua trinh sort.\n"	#d4
	low: .asciiz "low = "				#ed
	high: .asciiz ", high = "			#f4
	pivot: .asciiz ", pivot = arr[high] = "		#fe
	endline: .asciiz "\n"				#115
	pi: .asciiz "\tPivot Index la: "		#117
	notFound: .asciiz "\tLow co gia tri lon hon hoac bang High, return khoi ham Quicksort.\n"	#129
.text
	lui $a0, 0x00001001	# array address
	ori $a0, $a0, 0
	
	addi $a1, $0,  0	# low
	addi $a2, $0,  49	# high
	
	# begin (in qua trinh chay):
	addi $v0, $0, 4
#	la $a0, begin
	lui $a0, 0x00001001
	ori $a0, $a0, 0xd4
	syscall
	#(in qua trinh chay)
	
#	la $a0, arr	
	lui $a0, 0x00001001
	ori $a0, $a0, 0x0
	jal Quicksort
	
	# In ket qua
	addi $v0, $0, 4
#	la $a0, ketqua
	lui $a0, 0x00001001
	ori $a0, $a0, 0xc8
	syscall
	
	addi $t0, $0,  0
#	la $a1, arr
	lui $a1, 0x00001001
	ori $a1, $a1, 0x0
printLoop:
	lw $a0, 0($a1)
	addi $v0, $0, 1
	syscall	
	
	addi $v0, $0, 4
#	la $a0, space
	lui $a0, 0x00001001
	ori $a0, $a0, 0xd2
	syscall
	
	addi $a1, $a1, 4
	addi $t0, $t0, 1
#	beq $t0, 50, exitProgram
	addi $t7, $0, 50
	beq $t0, $t7, exitProgram
	j printLoop
exitProgram:
	addi $v0, $0, 10
	syscall	
	
# Than ham Quicksort($a0 = arr, &a1 = low, $a2 = high):
Quicksort:

#	(in qua trinh chay)
#	move $t9, $a0
	or $t9, $a0, 0
	
	addi $v0, $0, 4
#	la $a0, low
	lui $a0, 0x00001001
	ori $a0, $a0, 0xed
	syscall
	or $a0, $a1, $0
	addi $v0, $0, 1
	syscall	

	addi $v0, $0, 4
#	la $a0, high
	lui $a0, 0x00001001
	ori $a0, $a0, 0xf4
	syscall
#	move $a0, $a2
	or $a0, $a2, $0
	addi $v0, $0, 1
	syscall		
	
	addi $v0, $0, 4
#	la $a0, pivot
	lui $a0, 0x00001001
	ori $a0, $a0, 0xfe
	syscall
	sll $t8, $a2, 2
	addu $t8, $t8, $t9
	lw $a0, 0($t8)		# a0 = arr[high]
	addi $v0, $0, 1
	syscall
		
	addi $v0, $0, 4
#	la $a0, endline
	lui $a0, 0x00001001
	ori $a0, $a0, 0x115
	syscall
	
	or $a0, $t9, $0
#	(in qua trinh chay)	
	addi $sp, $sp, -4	# tao vung nho stack de luu gia tri thanh ghi tro ve.
	sw $ra, 0($sp)		# vi trong ham Quicksort co goi cac ham khac.	
#	bge $a1, $a2, exitQuicksort	# neu low >= high, thoat khoi ham.
	slt $t7, $a1, $a2
	beq $t7, $0, exitQuicksort
	
	jal partition		# goi ham partition de sap xep arr[high] vao dung vi tri (pi).

#	(in qua trinh chay)		
	or $t9, $a0, $0
	or $t8, $v0, $0
	
	addi $v0, $0, 4
#	la $a0, pi
	lui $a0, 0x00001001
	ori $a0, $a0, 0x117
	syscall
	
	or $a0, $t8, $0
	addi $v0, $0, 1
	syscall
	
	addi $v0, $0, 4
#	la $a0, endline
	lui $a0, 0x00001001
	ori $a0, $a0, 0x115
	syscall
	
	or $v0, $t8, $0
	or $a0, $t9, $0
#	(in qua trinh chay)	
	# Luu cac gia tri vao stack vi trong qua trinh goi ham long nhau, cac ham con se lam thay doi cac gia tri nay
	addi $sp, $sp, -8
	sw $v0, 4($sp)		# $v0 = pi
	sw $a2, 0($sp)
	
	addi $a2, $v0, -1	# new high = pi - 1
	jal Quicksort		# goi ham Quicksort(arr, low, pi - 1)
	
	lw $a2, 0($sp)		# tra lai gia tri high cu
	lw $a1, 4($sp)		
	addi $a1, $a1, 1	# new low = pi + 1

	addi $sp, $sp, 8	# su dung xong, tra lai vung nho stack
	jal Quicksort		# goi ham Quicksort(arr, pi + 1, high)
	
	# return
	lw $ra, 0($sp)
	addi $sp, $sp, 4
	jr $ra
	
exitQuicksort:
#	(in qua trinh chay)
	or $t9, $a0, $0
	or $t8, $v0, $0
	addi $v0, $0,  4
#	la $a0, notFound
	lui $a0, 0x00001001
	ori $a0, $a0, 0x129
	
	syscall
	or $v0, $t8, $0
	or $a0, $t9, $0
#	(in qua trinh chay)	
	addi $sp, $sp, 4
	jr $ra
	
# Than ham partition($a0 = arr, $a1 = low, $a2 = high)
partition:
	sll $t2, $a2, 2
	addu $t2, $t2, $a0
	lw $t0, 0($t2)		# t0 = arr[high]

	sll $t2, $a1, 2
	addu $t2, $t2, $a0	# t2 = dia chi bat dau, arr + low

	or $v0, $a1, $0		# v0 = i = low
	or $t1, $a1, $0 	# t1 = j = low
loopPart:
	lw $t3, 0($t2)		# t3 = arr[j]
#	blt $t0, $t3, checkCond	# swap gia tri chi khi arr[j] <= arr[high]
	slt $t7, $t0, $t3
	bne $t7, $0, checkCond
		sll $t4, $v0, 2
		add $t4, $t4, $a0	# arr[i]
		lw $t5, 0($t4)		
		sw $t3, 0($t4)		# luu arr[j] vao arr[i]
		sw $t5, 0($t2)		# luu arr[i] vao arr[j]
		addi $v0, $v0, 1	# i = i + 1
checkCond:	
	addi $t2, $t2, 4
	addi $t1, $t1, 1	# j = j + 1
	# dieu kien dung: j == high
#	bge $t1, $a2, exitLoopPart
	slt $t7, $t1, $a2
	beq $t7, $0, exitLoopPart
	
	j loopPart
exitLoopPart:
	# swap arr[i] va arr[high]
	sll $t2, $v0, 2
	addu $t2, $t2, $a0	# arr[i]
	lw $t1, 0($t2)
	sw $t0, 0($t2)

	sll $t2, $a2, 2
	addu $t2, $t2, $a0	# arr[high]
	sw $t1, 0($t2)
	
	jr $ra
	
	
	
	
	
